/* ===============================================================================
 * alton.js v1.2.0
 * ===============================================================================
 * Copyright 2014 Paper Leaf Design
 * http://www.paper-leaf.com
 *
 * Author: Paper Leaf
 *
 * A full featured scrolling plugin for creating
 * immersive featured sections or headers.
 *
 * Credit:
 * is_mobile() based off these helpful posts
 * - http://stackoverflow.com/questions/3514784/what-is-the-best-way-to-detect-a-handheld-device-in-jquery
 *
 * Getting stable scroll events was helped hugely by Huge Inc's insights
 * - http://www.hugeinc.com/ideas/perspective/scroll-jacking-on-hugeinc
 *
 * Stabilizing keypress events was helped in large part by jQuery OnePage Scroll
 * - https://github.com/peachananr/onepage-scroll
 *
 * License: GPL v3
 * =============================================================================== */(function(e){"use strict";var t={firstClass:"header",fullSlideContainer:"full",singleSlideClass:"slide",nextElement:"div",previousClass:null,lastClass:"footer",slideNumbersContainer:"slide-numbers",bodyContainer:"pageWrapper",scrollMode:"featuredScroll",useSlideNumbers:!1,slideNumbersBorderColor:"#fff",slideNumbersColor:"#000",animationType:"slow"};e.fn.alton=function(n){function T(t){if(t==="featuredScroll"){for(x=s.length-1;x>=0;x-=1)if(C())if(e(s[x]).height()>y)e(s[x]).css("height",e(s[x]).height());else{e(s[x]).css("height",y);e(s[x]).outerHeight(y)}else{e(s[x]).css("height",y);e(s[x]).outerHeight(y)}if(r.useSlideNumbers&&!C()){e("."+r.bodyContainer).append('<div id="'+r.slideNumbersContainer+'"></div>');e("#"+r.slideNumbersContainer).css({height:"100%",position:"fixed",top:0,right:"0px",bottom:"0px",width:"86px","z-index":999});C()&&e("#"+r.slideNumbersContainer).css({height:"auto","min-height":"100%"});e("."+r.bodyContainer+" #"+r.slideNumbersContainer).append("<ul></ul>");e("."+r.bodyContainer+" #"+r.slideNumbersContainer+" ul").css({transform:"translateY(-50%)","-moz-transform":"translateY(-50%)","-ms-transform":"translateY(-50%)","-o-transform":"translateY(-50%)","-webkit-transform":"translateY(-50%)",top:"50%",position:"fixed"});var n=0;while(n<p){e("."+r.bodyContainer+" #"+r.slideNumbersContainer+" ul").append('<li class="paginate"></ul>');N()?e(".paginate").css({cursor:"pointer","border-radius":"50%","list-style":"none",background:r.slideNumbersBorderColor,"border-color":r.slideNumbersBorderColor,"border-width":"2px","border-style":"solid",height:"11px",width:"11px",margin:"5px 0"}):e(".paginate").css({cursor:"pointer","border-radius":"50%","list-style":"none",background:r.slideNumbersBorderColor,"border-color":r.slideNumbersBorderColor,"border-width":"2px","border-style":"solid",height:"10px",width:"10px",margin:"5px 0"});n+=1}"getElementsByClassName"in document?d=document.getElementsByClassName("paginate"):d=document.querySelectorAll(".paginate")}}else{e("."+r.firstClass).css("height",y+10);if(!e("."+r.firstClass).hasClass("active")){e("."+r.firstClass).toggleClass("active");N()&&e(".paginate.active").css({"margin-left":"-1px","border-color":"#"+r.slideNumbersBorderColor,"border-style":"solid","border-width":"2px",height:"8px",width:"8px"})}}}function N(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");return t>0||navigator.userAgent.match(/Trident.*rv\:11\./)?!0:!1}function C(){return navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry|BB10|Windows Phone|Tizen|Bada)/)}function k(t,n){if(n&&e(d[e(t).parent().children().index(t)]).hasClass("active")){e(d[e(t).parent().children().index(t)]).toggleClass("active");e(d[e(t).parent().children().index(t)]).css("background",r.slideNumbersBorderColor)}else if(!e(d[e(t).parent().children().index(t)]).hasClass("active")){e(d[e(t).parent().children().index(t)]).toggleClass("active");e(d[e(t).parent().children().index(t)]).css("background",r.slideNumbersColor)}}function L(t){r.useSlideNumbers&&(t?e("#"+r.slideNumbersContainer).fadeIn():e("#"+r.slideNumbersContainer).fadeOut())}function A(t){var n=document.getElementsByClassName(i);e(document).scrollTo(e(n[t]));f=n[t];e(f).prev().hasClass(i)?c=e(f).prev():c=e("."+r.firstClass);e(f).next().hasClass(i)?l=e(f).next():l=e("."+r.lastClass);k(e("#"+r.slideNumbersContainer+" li.active"),!0);k(n[t],!1)}function O(){if(e(l).length>0||e(c).length>0)if(e(window).scrollTop()>=e("."+i+":first").offset().top&&e(window).scrollTop()+e(window).outerHeight()!==e(document).outerHeight()){r.useSlideNumbers&&k(f,!0);e("."+i).each(function(){S=e(this).offset().top;if(S<=e(window).scrollTop()){e(this).prev().hasClass(i)?c=e(this).prev():c=e("."+r.firstClass);f=e(this);f.next().hasClass(i)?l=e(this).next():l=e("."+r.lastClass);v=!1}});r.useSlideNumbers&&k(f,!1);e(document).scrollTo(f)}else{if(r.useSlideNumbers)if(h!==e("."+i+":last-child")[0])L(!1);else{L(!0);k(f,!1)}e(document).scrollTo(f)}}function M(e){e=e||window.event;if(e.preventDefault){e.stopPropagation();e.returnValue=!1}}function _(e){return M(e)}function D(){return window.pageYOffset||w.scrollTop}function P(t){o=e("body,html").is(":animated")||e("body").is(":animated")||e("html").is(":animated");if(t.type=="mousewheel"){clearTimeout(e.data(this,"scrollTimer"));e(document).unbind({scroll:P});e.data(this,"scrollTimer",setTimeout(function(){b=!1;e(document).bind({scroll:P})},35));if(t.originalEvent.detail>1&&!b||t.originalEvent.wheelDelta<-1&&!b){g+=1;e(document).moveDown();b=!0;M()}else if(t.originalEvent.detail<-1&&!b||t.originalEvent.wheelDelta>1&&!b){m+=1;e(document).moveUp();b=!0;M()}}else if(t.type=="scroll"){M();b=!1;clearTimeout(e.data(this,"scrollTimer"));e.data(this,"scrollTimer",setTimeout(function(){O()},500))}return!1}function H(t){E=D();if(t.originalEvent.detail>0||t.originalEvent.wheelDelta<0){if(!(e(l).offset().top>0&&E<e("."+r.firstClass).outerHeight()))return!0;if(e("."+r.firstClass).hasClass("active")){e("."+r.firstClass).toggleClass("active");e(document).scrollTo(l);c=f;f=l;return _(t)}if(!e("html, body").is(":animated"))return!0}else if(!e("."+r.firstClass).hasClass("active")&&e(window).scrollTop()<=e("."+r.firstClass).outerHeight()){e("."+r.firstClass).toggleClass("active");e(document).scrollTo(c);l=f;f=c}else if(!e("html, body").is(":animated"))return!0;return!1}var r=e.extend(!0,{},t,n),i=r.singleSlideClass,s,o,u=!1,a=!1,f,l=e("."+i+":first"),c=null,h=e("."+r.lastClass),p=e("."+r.fullSlideContainer).children().length,d,v=!0,m=0,g=0,y=e(window).outerHeight(),b=!1,w=window.document.documentElement,E,S,x;"getElementsByClassName"in document?s=document.getElementsByClassName(i):s=document.querySelectorAll("."+i);if(e("."+r.firstClass).length>0)f=e("."+r.firstClass);else{c=null;f=l;l=f.next();h=e("."+i+":last-child")[0]}if(r.scrollMode==="headerScroll"){f=e("."+r.firstClass);l=e("."+r.bodyContainer+":first")}e.fn.moveDown=function(){E=D();if(E>=0&&E<=e(f).scrollTop()&&v===!0){c=f;f=l;l=f.next();if(r.useSlideNumbers)if(h===e("."+i+":last-child")[0]){k(c,!0);k(f,!1)}else{k(f,!1);L(!0)}v=!1;e(document).scrollTo(f)}else if(!o&&l&&e(f).offset().top<E+1)if(l.hasClass(i)){c=f;f=l;l=e(f).next();if(r.useSlideNumbers){k(c,!0);k(f,!1)}e(document).scrollTo(f)}else if(h!==e("."+i+":last-child")[0]){c=e("."+i+":last-child")[0];f=h;l=null;if(e(window).scrollTop()+y+10>=e(document).outerHeight()-e(h).outerHeight()&&r.useSlideNumbers){k(c,!1);L(!1)}e(document).scrollTo(f);e.event.trigger({type:"lastSlide",slide:h,time:new Date})}};e.fn.moveUp=function(){E=D();if(e("."+r.fullSlideContainer).offset().top+1>E&&c&&E>0){if(e(f).offset().top>=E){f=e("."+r.firstClass);c=null;l=e("."+i);if(r.useSlideNumbers){L(!1);k(l,!1)}v=!0}else{f=c;c=null;l=e("."+i);if(r.useSlideNumbers){k(f,!0);k(c,!0)}}e(document).scrollTo(f)}else if(!o&&e("."+r.fullSlideContainer).offset().top<E){f=c;c=e(f).prev();l=e(f).next();if(r.useSlideNumbers){k(f,!1);k(l,!0);L(!0)}e(document).scrollTo(f)}a=!0;u=!1};e.fn.scrollTo=function(t){t!==h?e("body,html").stop(!0,!0).animate({scrollTop:e(t).offset().top},{duration:375}):e("body,html").stop(!0,!0).animate({scrollTop:e(document).outerHeight()-y},{duration:375})};e(document).ready(function(){T(r.scrollMode);r.scrollMode==="featuredScroll"&&!C()&&O();if(r.scrollMode==="featuredScroll"&&!C()){e("#"+r.slideNumbersContainer+" li").on("click",function(){A(e(this).parent().children().index(this))});var t=[];onkeydown=onkeyup=function(n){n=n||event;t[n.which]=n.type=="keyup";switch(n.which){case 40:n.preventDefault();e(document).moveDown(n);break;case 32:n.preventDefault();t["16"]==1?e(document).moveUp(n):e(document).moveDown(n);break;case 33:e(document).moveDown(n);n.preventDefault();break;case 34:n.preventDefault();e(document).moveUp(n);break;case 38:n.preventDefault();e(document).moveUp(n);break;case 36:n.preventDefault();if(e("."+r.firstClass).length!==0){r.useSlideNumbers&&k(f,!0);c=null;f="."+r.firstClass;l=e("."+i+":first");r.useSlideNumbers&&k(f,!1);e(document).scrollTo("."+r.firstClass)}else{r.useSlideNumbers&&k(f,!0);c=null;f=e(".pane:first");l=f.next();e(document).scrollTo(e(".pane")[0]);r.useSlideNumbers&&k(f,!1)}break;case 35:if(e("."+r.firstClass).length!==0){if(r.useSlideNumbers){k(e(f),!0);k(e(".pane:last"),!1)}c=e(".pane:last")}else{if(r.useSlideNumbers){k(e(f),!0);k(e(h),!1)}c=e(h).prev()}f=e(h);l=null;n.preventDefault();e(document).scrollTo(h);break;default:n.preventDefault()}}}if(!C()){r.scrollMode==="featuredScroll"?e(document).bind({"DOMMouseScroll mousewheel scroll":P}):r.scrollMode==="headerScroll"&&e(document).bind({"DOMMouseScroll mousewheel":H});e(window).resize(function(){e(s).each(function(){e(this).css("height",e(window).outerHeight());e(this).outerHeight(e(window).outerHeight())})})}})}})(jQuery);
